#!/bin/bash

URL="https://storage.googleapis.com/oplabs-mainnet-data/mainnet-bedrock.tar"
DEST_DIR="/home/ethereum/.op-geth-tmp"
OPGETH_DIR="/home/ethereum/.op-geth"

mkdir -p $DEST_DIR

echo "Downloading $URL to $DEST_DIR ..."
curl --progress-bar --location --output "$DEST_DIR/mainnet-bedrock.tar" "$URL"

# extract the downloaded file
echo "Extracting $DEST_DIR/mainnet-bedrock.tar ..."
tar -xf "$DEST_DIR/mainnet-bedrock.tar" -C "$OPGETH_DIR" --strip-components=1

# clean up
echo "Cleaning up ..."
rm -rf "$DEST_DIR"
