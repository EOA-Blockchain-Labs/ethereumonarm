# /etc/ethereum/op-challenger.conf

# Configuration for Optimism Fault Proof Challenger
# See https://docs.optimism.io/op-stack/fault-proofs/challenger
# and https://github.com/ethereum-optimism/optimism/tree/develop/op-challenger

# ------------------------------------------------------------------------------
# General Configuration
# ------------------------------------------------------------------------------
# Directory to store challenger data
DATADIR="/home/ethereum/.op-challenger"

# Number of L1 confirmations required
NUM_CONFIRMATIONS=1

# ------------------------------------------------------------------------------
# RPC Endpoints
# ------------------------------------------------------------------------------
# L1 Ethereum Execution Layer RPC (e.g. Geth, Nethermind)
L1_ETH_RPC="http://localhost:8545"

# L1 Beacon Chain RPC (e.g. Lighthouse, Prysm)
L1_BEACON_RPC="http://localhost:5052"

# L2 Rollup Node RPC (op-node)
ROLLUP_RPC="http://localhost:8547"

# L2 Execution Layer RPC (op-geth)
L2_ETH_RPC="http://localhost:9545"

# ------------------------------------------------------------------------------
# Game Configuration
# ------------------------------------------------------------------------------
# Network name for well-known networks (recommended)
# Options: op-mainnet, op-sepolia, base-mainnet, base-sepolia
NETWORK="op-mainnet"

# Alternative: Address of the DisputeGameFactoryProxy contract (for custom chains)
# Use this instead of NETWORK for custom OP Stack chains
# Check https://docs.optimism.io/chain/addresses for addresses
# GAME_FACTORY_ADDRESS="0x..."

# Trace types to use for generating fault proofs
# Available options: cannon, cannon-kona, permissioned, asterisc, asterisc-kona
# IMPORTANT: The default includes asterisc-kona which requires the asterisc binary.
# Set to "cannon" or "cannon,permissioned" to use only Cannon (MIPS) VM.
TRACE_TYPE="cannon"

# Optional: Allowlist of dispute games to challenge (if restricted)
# GAME_ALLOWLIST="0x..."

# ------------------------------------------------------------------------------
# Cannon Trace Configuration
# ------------------------------------------------------------------------------
# Path to the cannon executable
CANNON_BIN="/usr/bin/cannon"

# Path to the op-program executable (server mode)
CANNON_SERVER="/usr/bin/op-program"

# URL to download prestates from (recommended for mainnet/well-known networks)
# Prestates will be automatically downloaded based on the game's absolute prestate hash.
CANNON_PRESTATES_URL="https://storage.googleapis.com/optimism-cannon-prestates/mainnet/"

# Alternative: Path to a local absolute prestate file
# Use this instead of CANNON_PRESTATES_URL for custom networks or offline operation.
# CANNON_PRESTATE="/path/to/prestate.bin.gz"

# Optional: Snapshot frequency
# CANNON_SNAPSHOT_FREQ=1000000000

# ------------------------------------------------------------------------------
# Transaction Signer
# ------------------------------------------------------------------------------
# You must specify either a Private Key or a Mnemonic (and optional HD path)

# Private Key (hex string with or without 0x prefix)
# PRIVATE_KEY=""

# Mnemonic string
MNEMONIC=""

# HD Path for Mnemonic (default: "m/44'/60'/0'/0/0")
HD_PATH="m/44'/60'/0'/0/0"

# ------------------------------------------------------------------------------
# Additional Arguments
# ------------------------------------------------------------------------------
# Add any other custom arguments here
EXTRA_ARGS=""

# ------------------------------------------------------------------------------
# Final Argument Construction
# ------------------------------------------------------------------------------
ARGS="--datadir=$DATADIR \
      --num-confirmations=$NUM_CONFIRMATIONS \
      --l1-eth-rpc=$L1_ETH_RPC \
      --l1-beacon=$L1_BEACON_RPC \
      --rollup-rpc=$ROLLUP_RPC \
      --l2-eth-rpc=$L2_ETH_RPC \
      --trace-type=$TRACE_TYPE \
      --cannon-bin=$CANNON_BIN \
      --cannon-server=$CANNON_SERVER \
      --cannon-prestates-url=$CANNON_PRESTATES_URL \
      $EXTRA_ARGS"

# Add Network or Game Factory Address
if [ -n "$NETWORK" ]; then
    ARGS="$ARGS --network=$NETWORK"
elif [ -n "$GAME_FACTORY_ADDRESS" ]; then
    ARGS="$ARGS --game-factory-address=$GAME_FACTORY_ADDRESS"
fi

# Add Allowlist if set
if [ -n "$GAME_ALLOWLIST" ]; then
    ARGS="$ARGS --game-allowlist=$GAME_ALLOWLIST"
fi

# Add Signer configuration
if [ -n "$PRIVATE_KEY" ]; then
    ARGS="$ARGS --private-key=$PRIVATE_KEY"
elif [ -n "$MNEMONIC" ]; then
    ARGS="$ARGS --mnemonic=\"$MNEMONIC\" --hd-path=\"$HD_PATH\""
fi
