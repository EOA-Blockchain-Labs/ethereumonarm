# Kernel tweaks for improved Ethereum node performance

# Optimize swap usage: Lower value means kernel prefers to keep data in RAM longer.
vm.swappiness=1

# Filesystem caching and disk I/O behavior:
# vm.dirty_ratio: Max percentage of total system memory that can hold dirty (unsaved) pages. (e.g., 40%)
# vm.dirty_background_ratio: Percentage of system memory at which background write-out of dirty pages starts. (e.g., 10%)
# These can influence how aggressively data is written to disk.
vm.dirty_ratio=40
vm.dirty_background_ratio=10
# vm.vfs_cache_pressure: Controls tendency of kernel to reclaim memory used for caching directory and inode objects.
# Lower values (e.g., 50) make kernel favor keeping these caches.
vm.vfs_cache_pressure=50

# Network throughput optimizations:
# Increase maximum socket receive buffer (rmem_max) and send buffer (wmem_max) sizes. (12MB here)
net.core.rmem_max=12582912
net.core.wmem_max=12582912
# Configure TCP receive memory (min, default, max).
net.ipv4.tcp_rmem=10240 87380 12582912
# Configure TCP send memory (min, default, max).
net.ipv4.tcp_wmem=10240 87380 12582912
# Increase maximum number of packets queued on the INPUT side, when interface receives packets faster than kernel can process.
net.core.netdev_max_backlog=2500
# Set TCP congestion control algorithm to BBR (Bottleneck Bandwidth and Round-trip propagation time).
# BBR often provides higher throughput and lower latency.
net.ipv4.tcp_congestion_control=bbr
